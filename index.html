<html>
    <head>
        <title>Open Api Test</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <meta name="format-detection" content="telephone=no">
        <style type="text/css">
        *{margin: 0;padding: 0}
        .container{
        	margin: 200px 20px 20px 20px
        }
        .api{
        	display: block;
        	height: 30px;
        	width: 100%;
        	text-align: center;
        	background-color: #fefefe;
        	margin-bottom: 10px;
        }
        </style>
    </head>
    <body>
		<div id="container" class="container">
    </body>
<script src="./Native.debug.js"></script>
<script src="./Native.js"></script>
<script type="text/javascript">
;(function () {
	var container = document.getElementById('container');
	var invoke = NativeApi.invoke;

	function addButton(cmdName, func) {

	    var btn = document.createElement('button');
	    btn.setAttribute('class', 'api');
	    btn.innerHTML = cmdName;
	    btn.onclick = function(){
	        try{
	            func();
	        }catch(e){
	            throw e;
	        }
	    };
	    container.appendChild(btn);
	}

	addButton('config', function() {
		NativeApi.invoke("config", {
			appid: "101490554",
			permission: function (code) {
				alert("permission - " + code);
			},
			success: function (res) {
				alert("success - " + JSON.stringify(res));
			},
			failure: function (code, msg) {
				alert("failure - [" + code + "] " + msg);
			}
		});
	});

	addButton('getCity', function() {
		invoke("getCity", {
			permission: function (code) {
				alert("permission - " + code);
			},
			success: function (res) {
				alert("success - " + JSON.stringify(res));
			},
			failure: function (code, msg) {
				alert("failure - [" + code + "] " + msg);
			}
		});
	});
	
	addButton('setShareInfo', function() {
		NativeApi.invoke('setShareInfo', {
			'title': 'title',
			'share_url': location.origin + '/share',
			'desc': 'desc',
			'image_url': 'https://assets-cdn.github.com/images/icons/emoji/unicode/1f4d7.png',
			'success': function() { alert('success'); }
		});
	});
	
	function onActionClick() {
		NativeApi.invoke('showActionSheet', {
			'itemList': ['修改昵称', '修改个性签名'],
			'cancelText': '取消',
			'success': function(res) {
				alert(JSON.stringify(res));
			}
		});
	}

	addButton('setShareInfo', function() {
		NativeApi.invoke('setActionButton', {
			'title': '编辑',
			'iconID': 1,
			'success': function() { alert('success'); },
			'trigger': onActionClick
		});
	});

})();
</script>
</html>